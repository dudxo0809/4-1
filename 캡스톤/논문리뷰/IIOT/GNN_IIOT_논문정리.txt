[[ Graph_Neural_Networks_for_Anomaly_Detection_in_Industrial_Internet_of_Things ]]
[[ The Industrial Internet of Things ]]

[[ 개요 ]] 
IIOT는 산업용 사물 인터넷

graph-level anomaly detection 은 복잡한IIOT인프라 내에서 중요한 이상치탐지 수단이다.

IIOT를 이용한 스마트교통 , 스마트 에너지, 스마트 공장에서 사용하는 graph neural networks (GNN) 

[[ 1페이지 ]]
이상탐지는 중요하다.
이상을 미리 감지하지 못하면 큰 손해를 볼 수 있다.

장치들이 서로 연결된 IIOT 특성상 GNN구조가 유리하다.

[[ 2페이지 ]]

#
GNN구조를 적용할 IIOT의 고유한 특성을 고려하여, GNN모델을 설계해야한다
(가령 Graph convolutional networks - GCN 은 노드의 1단계이웃을 고려하여 동작)
(Graph attention networks - GAN은 인접 노드별로 다른 가중치를 설정가능)

#
섹션1 : IIOT분야에서 이상치탐지의 중요성
섹션2 : IIOT소개와 IIOT에서 발생가능한 세가지 anomaly 유형 설명
섹션3 : 주요 GNN모델들 요약
섹션4~6 : 유용한 공공 데이터셋, GNN기반 이상치탐지 방법및 연구과제,
[ IIOT 스마트 운송 ][ 스마트에너지 ][ 스마트팩토리 ] 에 관한 open issue들
섹션7 : 위 세 분야에서 GNN을 사용한 사례 분석
섹션8 : 마무리

[[ 2페이지 ]] [[ 섹션2 ]]
  --- IIOT와 IIOT에서 발생가능한 세가지 anomaly 유형 설명 (각A와 B 파트)---

[[ A ]]
#
IIOT란? : IOT와 유사하지만 다름
일상생활에서 소비자가 다루는 장치에 사용되는 IOT와 달리
물,건강,에너지,국방 과 같은 고위험 산업에서 사용되는 보다 정교하고 중요한 장치를 사용한 사물인터넷기술을 말함.

#
IIOT는
-유무선 네트워크를 통해 센서,계측기,기타 산업용 장치들을 연결하고
-이를통해 생성한 데이터를 분석하여
-산업 비즈니스 운영을 자동화하고
-기대수익을 높이는 기능을 가짐.

#
데이터분석이 가장 중요

(5G기술 이용시 제곱킬로미터당 350,00개 이상의 장치 연결 가능 기존기술의 500배)
(이는 IIOT데이터분석이 어려움을 뜻함, 점점 더 어려워질듯)

그림2를통해 스마트 에너지의 흐름에대해 설명하는내용

[[ 3페이지 ]] [[ 섹션2 ]]
[[ B ]]
#
IIOT에서 발생가능한 이상치 유형들

1) Point - 특별한 이유없이 무작위로 발생하는 이상
ex) 산업용 네트워크의 라우터/스위치의 출구포트에 순간적으로 많은 양의 트래픽이 몰리면 이것을 Point형 이상치 라고 할 수 있다

2) Contextual - 특정 맥락(or 상황)에서 나타나는 이상 -> 이는 맥락(시간,공간,트래픽 패턴에서 보이는 행동특징등)을 고려하면 식별 가능
ex) 주중 산업 사무실의 네트워크 트래픽이 일반적으로는 주말보다 훨씬 높음

3) Collective - Point형 이상들의 집합을 뜻함 이러한경우, 개별적으로 나타나는 Point이상치는 정상으로 취급하지만 집단으로 나타나면 이상으로 취급함
ex) 특정구간의 트래픽이 평소보다 높다면 이를 Collective형 이상치 라고 볼 수 있음
또한, IIoT 장치의 프로그램을 패치/업그레이드 하고나서 장치의 동작을 관리하는 컨트롤러를 업그레이드하지 않은 경우 Collective이상이 발생할 수 있다.

[[ 3페이지 ]] [[ 섹션3 ]]
 --- 주요 GNN모델들 요약 ---

#
GNN은 더 일반화된 CNN이다 (여러곳에 적용 가능한).
CNN은 1,2차원 데이터에 적용가능하고 GNN은 소셜네트워크, 3차원 데이터 등에 적용 가능하다.

#


[[3페이지]] [[ 섹션3-A : GCN ]] 
#
GCN은 Graph Convolutional Networks이다.
GNN의 기본 변형중 하나로 CNN처럼 input neurons에 가중치(kernels)를 곱하는방식이다.

https://dbstndi6316.tistory.com/250
연결된 노드들의 특성을 같이 학습할 수 있도록 노드연결성(인접행렬)에 노드특성(특성행렬)을 곱해서 사용

Spectral GCN (스펙트럼 GCN)
Laplacian filter를 이용해서 이미지속 오브젝트(노드)들간의 경계를 판단하고 이를 이용해서 노드들간의 거리를 계산하여 활용할 수 있게 해주는GCN
https://tootouch.github.io/research/spectral_gcn/

spatial GCN (공간 GCN)
노드의 이웃들에 순서를 매겨야하는 상황에서 쓸 수 있음 노드가 위치한 공간특징을 활용함

=====STGCN (Spatial-Temporal GCN)
=====공간 및 시간 특성을 활용한 GCN, ##(시계열 데이터에 활용할 수 있을것으로 보임)##
=====스마트교통, 스마트에너지, 스마트공장에 활용됨

[[4페이지]] [[ 섹션3-B : GCN ]] 
#
GAN은 Graph Attention Networks이다.
이웃노드의 중요도에따라 다른 가중치를 할당가능

[[3페이지]] [[ 섹션3-C : GGSNN, GGNN ]]
#
GGNN은 Gated Graph (Sequence) Neural Networks이다.
-GCN과 GAN은 분류문제와같이 단순한 output을 내는 모델

단순한 output대신 output sequence를 출력하기위해 GRU나 LSTM이 정보의 전파 단계에 사용되어 정보의 전파 길이를 늘림
GGNN은 GRU를 사용한GNN이고 GGSNN은 output sequence를 생성하기위해 여러GGNN들을 이어붙인 GNN모델이다.


[[4페이지]] [[ 섹션3-D : JKN ]]
#
Jump Knowledge Network구조 - 각각의 레이어를 거치며 나온 임베딩값을 마지막단계에 모두 사용하는 임베딩구조
이미지의 지역정보를 집계할때 노드간의 거리가 너무 가까우면 발생하는 over-smoothing 문제를 해결할 수 있다.
-
논문에서는 그래프 특성을 행렬로 변환할때, 각노드에 적용할 이웃의 범위를 바꾸는 기능을 한다고함.


노드의 특성


[[4페이지]] [[ 섹션3-E : Self-Enhanced GNN ]]
#
반지도학습 분류문제에서의 성능 향상을 위해 기존GNN모델의 OUTPUT을 사용하여 입력 데이터의 품질을 개선하는 GNN모델

---------------------------------------------------------------------------------------------------------------------------------------------
[[4페이지]] [[ 섹션4 : IIOT-Enabled Smart Transportation ]]
#
스마트 교통 분야에서 사용되는 IIOT와 이상치탐지 사례

현대의 도로는 다양한 교통센서, 네비게이션 위성시스템, 레이더, 루프검출기, 적외선카메라 등 방대하고 다양한 유형의 기기들이 교통데이터를 주고받으며
교통 인프라를 만들고있다.

교통 이상에는 비정상적인 교통 정체, 교통사고, 손상된 교통인프라시설 등이 있는데, 이를 이상치라고 볼 수 있다.

[[5페이지]] [[ 섹션4 : Point ]]
#
스마트 교통 분야에서 point이상치는 고속도로에서 고장난 차량이나 군중의 비정상적인 행동으로 볼 수 있다.
이를 위한 공개 데이터 세트로는 UCSD dataset가 있다.
이는 각 200프레임인 98개의 비디오들로 구성되어있고 차량과 군중들의 움직임이 담겨있다.

#
UCSD dataset의 노이즈를 제거한뒤 GCN기반 분류작업을 진행한 과정을
Graph convolutional label noise cleaner: Train a plug-and-play action classifier for anomaly detection
위 논문에서 찾아볼 수 있다.

[[5페이지]] [[ 섹션4 : Contextual ]]
#
스마트 교통 분야에서 contextual이상치의 예로는 밀집된 도로에서 고속으로 주행하는 차를 들 수 있다.
고속으로 주행하는차는 밀집된 도로에서는 이상치로 분류되지만 고속도로에서는 정상적인 사건이라고 볼 수 있다.
이를 위한 공개 데이터 세트로는 Uber Movement 데이터세트가 있다.
여기에는 미국의 여러 도시에 걸친 Uber 승차 공유 서비스의 이동시간, 장소, 목적지가 포함되어있다.

#
이런 Contextual이상치들을 검출한 연구들은
“Graph convolutional networks for traffic anomaly" ( 2020 ) 
"RiskOracle: A Minute-Level Citywide Traffic Accident Forecasting Framework,” ( 2020 )
위 논문들에서 찾아볼 수 있다.
각각 Context-augmented Graph Autoencoder( Con-GAE )와
DTGN(Differential Time-Vary Graph Neural Network) 라는 알고리즘을 이용했다.

[[6페이지]] [[ 섹션4 : Collective ]]
#
스마트 교통 분야에서 contextual이상치의 예로는 고속도로에서 차량떼가 천천히 움직이는 경우로 볼 수 있습니다.
이를 위한 공개 데이터 세트로는 NYC택시 데이터 세트와 UMN데이터 세트 등이 있습니다.

#
이런 Collective이상치를 검출한 연구들은
“ST-MFM: A Spatiotemporal Multi-modal Fusion Model for Urban Anomalies Prediction" (2020)
“A multimodal graph neural network approach to traffic risk forecasting in smart urban sensing" (2020)
위 논문들에서 찾아볼 수 있다.
각각 ST-MFM과 GAN을 활용했다.

[[6페이지]] [[ 섹션4 : 도전과제와 미해결과제 ]] Challenges and Open Issues
#
스마트 교통 IIOT분야에서 GNN은 좋은 해결책이 될 수 있지만, 아직 해결해야할 문제점들이 몇가지 있습니다.

1. 교통상황의 데이터는 도로 구조나 기상조건같은 외부요인들에 영향을 받기 쉽습니다.

2. 모델을 학습시킬때 사용할 데이터에 이상치가 정상적인 데이터에 비해 극히 소량일 가능성이 높습니다.

3. 교통데이터에는 모델의 훈련이 끝나지 않을만큼 엄청 방대한 특성들이 포함될 수 있습니다.

이런 다양한 상황들에 대응되도록 모델을 만들어야합니다.
#


[[7페이지]] [[ 섹션5 ]]

[[9페이지]] [[ 섹션6 ]]


[[12페이지]] [[ 섹션7 Case Studies ]]
#
7장


A) 대중교통체계에서의 집단이상검출을 위한 STGNN 기반 모델

	STGNN 기반 모델은 공간-시간적 특징에서 함께 학습할 수 있는 강력한 능력
	
	어떻게 STGNN기반 모델이 대중교통 시스템에서 집단 이상 징후를 감지하는 데 사용될 수 있는가?
	-> 그림 7은 트래픽 이상 탐지를 위해 제안된 STGNN을 보여준다
	-> 3단계의 작동과정
	1단계)
		시간에 따른 군중의 흐름데이터를 얻음
		-> (대중교통 시스템의 체크인/아웃 기록(즉, 근거리 무선 통신 기반 토큰 또는 카드에 의해 기록됨))
		-> 사고, 사건 수집, 범죄 보고서, 다른 공공 사건에 대한 과거의 기록으로부터 교통 이상 현상정보를 얻음
	2단계)
		트래픽 흐름 데이터를 그래프로 변환
	3단계)
		여러 계층으로 구성된 STGNN을 구성
		-> 첫 번째 GNN 계층은 공간적 특징을 포착
		-> 두 번째 LSTM 계층은 과거 트래픽 흐름에서 시간적 특징을 추출하는 데 사용
		그런 다음 다른 GNN 계층을 채택하여 처음 두 계층에서 얻은 공간-시간 종속성을 추가로 탐색
		최종적으로 예측(즉, 정상적인 트래픽 흐름에서 이상 징후를 분류)


B) 전력 변압기의 점 이상 검출을 위한 GCN

	고장난 변압기는 용존가스를 배출함
	-> 용존가스는 변압기의 고장해석을 위한 Point 이상으로 볼 수 있다.
	-> 전력 변압기의 점 이상을 감지하기 위한 GCN 기반 모델을 설계 (그림 8)

	1. 공개 데이터 세트에서 과거 DGA 데이터를 얻을 수 있다
	2. 샴 네트워크와 kNN(k-nearest neighbor) 접근법을 적용한 후, (S, A)로 구성된 잘 형성된 입력 데이터 세트를 생성
		여기서 S는 용해 가스의 특징 매트릭스를 나타내고 A는 인접 매트릭스를 나타낸다
		(즉, 과거 샘플과 현재 샘플 간의 유사성을 특징짓는다).
	3. 그림 8과 같이 입력 데이터 세트를 GCN에 공급
	
	과적합을 피하고, 학습효과 향상: 두 그래프 컨볼루션 레이어 사이에 드롭아웃 기반 은닉 레이어와 ReLU을 추가
	마지막으로 softmax함수를 적용 (이유는 잘 모르겠음)


C. 스마트 팩토리의 집단 이상 검출을 위한 GCN 기반 모델

	GNN을 스마트 공장에서 집단 이상 징후를 감지하는 데 사용할 수 있는 방법
	
	(스카트 팩토리에서의 이상현상?)
	그림 9 와 같이 스마트 공장에서 PLC는 제조 공정의 제어를 위해 설계된 산업용 디지털 컴퓨터이다. 
	각 PLC는 여러 IIoT 장치와 연결되며, PLC는 종종 다른 PLC에 네트워크로 연결된다.
	IoT 장치는 일반적으로 보안상의 이유로 패치를 적용해야 합니다. 
	환경 제어 장치 및 로봇 제어 장치와 같은 여러 IIoT 장치의 프로그램이 변경/패치되었지만 
	해당 PLC(Programmable Logic Controller)가 업그레이드되지 않을 때 집단 이상 현상이 발생
	
	(어떻게 감지?)
	기존의 많은 이상 감지 방법은 IIoT 장치 또는 PLC의 기능만 고려함
	그러나 집단 이상 징후를 감지하기 위해서는 IIoT 장치 또는 PLC 간의 관계도 중요하다. 
	GNN은 이러한 관계를 포착할 수 있는 좋은 후보이므로 집단 이상 징후를 효과적으로 탐지 가능

	1. 첫째, 산업 통신 네트워크와 IIoT 장치 및 PLC의 동작을 그래프로 변환
		-> node : IIoT 장치와 PLC 및 기타 가능한 공장 장치
		-> edge : 이러한 장치의 구조적 정보
	2. GCN 기반 이상 탐지 모델을 설계
		-> 소프트맥스 층을 가진 n층 GCN 모델 (정상/비정상 분류하는 모델)
		-> GCN 모델은 각 노드에 대해 정상 및 비정상 이진 분류를 출력할 수 있다.
		-> softmax함수는 논문에 수식이 있음
		(수식설명)
		α : 소프트맥스
		~zi :  입력 벡터
		e^zi : 입력 벡터의 표준 지수 함수
		e^zk :  출력 벡터의 표준 지수 함수

	(모델의 입력)
	GCN 모델의 입력 : IIoT 장치와 PLC를 기능이 있는 노드 & 노드 간의 연결을 그래프의 가장자리로 포함하는 그래프 
			두 개의 행렬로 이루어짐 (하나는 노드 기능 행렬 & 다른 하나는 노드 인접 행렬)









































