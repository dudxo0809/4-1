프로젝트 주제 : 시계열 데이터의 Anomaly Detection (이상치 탐지) 알고리즘 및 모델 제작

@@1. 팀 및 주제 소개 @@

#1.

이상태로 조금 대기

#2.
안녕하십니까 와! 머신러닝 아시는구나 팀의 김대희입니다.
지금부터 캡스톤 프로젝트 중간결과 발표를 시작하겠습니다.

#3.
목차는 다음과 같습니다.

#4.
-------------------------------------------------------------------챕터1. [Project outline]---------------------------------------------------------------

#5.
금융, 네트워크관리, 의료등의 산업데이터에서 비정상적인 데이터 즉 이상치를 찾아내는것은 중요한 문제입니다.
이때 '이상치' 라는것은 불법적인 거래내역일수도있고, 네트워크의 통신오류일수도 있고, 미지의 병에의해 변질된 생체신호 일수도 있습니다.
이런 산업 데이터속 이상치들을 빠르고 정확하게 찾아낸다면 재산 및 인명 피해를 막을 수 있습니다.
그러나 소수의 이상치를 찾는 과정에서 수많은 정상데이터까지 함께 검토해야하기때문에, 이상치 탐지를 사람이 직접 진행하게된다면
굉장히 많은 시간이 소모될 확률이 높습니다.

#6.
이런 문제를 해결하기위한 방법을 찾아보니,
머신러닝 기법을 이용하면 인력소모를 줄이고 보다 빠르게 이상치를 검출해낼 수 있음을 알 수 있었습니다.
특히 머신러닝의 지도, 반지도, 비지도학습중 반지도 학습 알고리즘을 이용한다면 수집하기 어려운 이상치 대신
수집하기 쉬운 정상 데이터만을 가지고 이상치 탐지 모델을 만들어 활용할 수 있고,
비지도 학습 알고리즘을 이용한다면 다소 정확도는 떨어지지만 학습과정에서 사용할 가이드용 데이터가 따로 없어도
이상치 탐지 모델을 만들어 활용할 수 있기때문에 
이런 다양한 학습 알고리즘으로 여러 종류의 데이터들에 대응할 수 있다는 장점이 있었고
이 장점 때문에 머신러닝 기법이 다음 사진 자료에 나온
부정맥 검출에 도움을 주는 Aifib모델이나 제조 라인에서의 불량품 검사에 쓰이는 MOai모델처럼 다양한 형태로
이미 많은 분야에 활용되고 있음을 알 수 있었습니다. 

#7.
저희 팀의 목표는 추후 조교님을 통해 주어질 데이터세트에서 비정상 데이터를 검출해내는 시스템을 구현하는것 이였는데,
주어질 데이터세트가 정확히 어떤 분야의 데이터셋인지 아직 모르기때문에 이미 다양한 분야에 활용되고있는 
머신러닝 기법을 활용한 이상치 탐지 즉 Anomaly Detection알고리즘을 연구해두고,
이후 데이터를 받으면 연구한 알고리즘을 이용한 모델을 만들어 사용하기로 했습니다.

#8.
-------------------------------------------------------------------챕터2. [Three types of anomalys]---------------------------------------------------------------

#9.
앞서 말했듯이 각 산업 분야마다 이상치의 정의는 조금씩 다르겠지만 공통적으로 이런 산업분야에서 나타나는 이상치들을 크게 3종류로 분류할 수 있습니다.

#10.
먼저Contextual형 이상치는 특정 맥락또는 상황에서 나타나는 이상치입니다.
이는 시간,공간,트래픽 패턴등에서 보이는 행동특징을 고려하면 식별 가능한 이상치로
예를 들자면 작업량이 증가하는 특정시간대 마다 산업 사무실의 네트워크 트래픽이 주기적으로 높아져, 이상치로 판단되는 현상이 있습니다.

#11.
Point형 이상치는 Contextual형과 다르게 특별한 맥락없이 무작위로 발생하는 이상입니다.
예를들어 우연히 산업용 네트워크의 라우터/스위치의 출구포트에 순간적으로 많은 양의 트래픽이 몰리면 이것을 Point형 이상치 라고 할 수 있습니다.

#12.
마지막 Collective형 이상치는 Point형 이상치들의 집합을 뜻합니다.
예를들어 다음과같이 특정구간의 트래픽이 평소보다 높다면 이를 Collective형 이상치 라고 볼 수 있습니다.
이때, 간헐적으로 나타나는 Point이상치는 정상으로 취급하고 집단으로 발생한Collective형 이상치만 이상으로 취급하는 경우도 있습니다
저희는 추후 받을 dataset에서 collective형 이상치를 찾아내는 머신러닝 모델을 만드는것을 목표로하고있습니다.

#13.
-------------------------------------------------------------------챕터3. [Project dataset]---------------------------------------------------------------

#14.
저희 프로젝트에서 사용할 데이터셋은 multivariate time series data set 즉 다변량 시계열 데이터셋인데,
시계열 데이터셋이란 왼쪽 그래프의 데이터처럼 시간에따라 변화하는 데이터를 이용해 만든 데이터셋을 뜻합니다.
시계열 데이터의 예시로 오른쪽 사진과같이 코스피 지수들이 모여서 만들어진 주식 데이터와 
시간에따라 변화하는 환자의 심전도 데이터등이 있습니다.
다변량 시계열 데이터셋은 시간에 따라 함께 변하는 다양한 종류의 시계열 데이터들을 한번에 묶어서 만든 데이터셋입니다.

#15.
잠시 저번 제안서 발표때 사용한 프로젝트 진행상황 자료를 보며 발표를 이어나가겠습니다.

#16.
#17.
#18.
현재 진행중인 프로젝트 단계에서는 아직 받지 못한 이번 프로젝트의 시계열 data set 대신 Hai data set을 이용하여
Anomaly Detection 알고리즘과 모델을 만들고 있습니다.
Hai data set은 국가보안기술연구소에서 산업시설의 보안 강화를 위해 개발한 시계열 데이터로,
최종모델에 사용할 시계열 data set을 대신하여 Anomaly Detection알고리즘 및 모델 구현을 연습하기위해 사용하였습니다.
이때 Dacon에서 진행한 HAICON 산업제어시스템 보안위협 탐지 AI 경진대회를 통해
다양한 사람들이 만들어둔 Hai data set을 이용한 Anomaly Detection 모델들이 이미 존재했기때문에,
이중 공개된 모델들을 참고하였습니다.

#19.
앞으로 최종모델에 사용할 dataset제작용 tool이 도착하면 tool을 이용하여 만들어낼 시계열 data들의 특성을 파악하고,

#20.
파악한 특성과 Hai data set을통해 연습한 내용을 종합하여 최종 모델에 활용할 알고리즘을 구상할 생각입니다.

#21.
-------------------------------------------------------------------챕터4. [Project model]---------------------------------------------------------------

#22.
다음 프로젝트 진행상황에 나오듯이 현재는 계속 관련 논문과 기타 자료들을 살펴보며, 알고리즘과 모델을 직접 구상 및 구현해보는중입니다.
오른쪽 사진은 LSTM 알고리즘을 적용하여만든 anomaly detection모델을 이용하여, Hai dataset의 이상치를 탐지한 사진인데,
주황색 선에서 돌출된 부분이 실제 이상치data이고 파란색으로 돌출된 부분이 anomaly detection모델이 이상치라고 탐지한 data입니다.
해당 모델은 약 80%의 이상치를 제대로 판별해냈는데, 이상치 판별 성공률을 높이기 위해 다른 다양한 알고리즘이나 모델을 찾아보았습니다.

#23.
현재 만들어보고자 하는 모델은 GNN을 활용하는 모델입니다.
GNN은 Graph_Neural_Networks의 약자로, 그래프 신경망이라는 뜻입니다.
GNN기법을 활용하면 그래프의 형태로 표현한 데이터의 각 노드의 상태를 인접한 노드와의 상관관계를 이용하여 예측해낼 수 있습니다.

#24.
Hai dataset과같은 산업 데이터들은 특성들이 그래프처럼 서로 연결되어있는 구조이기때문에 GNN기법을 활용하기좋은 환경입니다.

#25.
다음은 관련논문을통해 알게된 GNN의 주요 변형 모델들입니다.
크게 5종류의 모델이 있으며 하나씩 간단하게 살펴보겠습니다.

#26.
GCN은 Graph Convolutional Networks의 약자입니다.
이는 GNN의 기본 변형중 하나로 CNN처럼 input neuron에 가중치kernel을 곱하는방식으로 작동합니다.
이때, 연결된 노드들의 특성을 같이 학습할 수 있도록 인접행렬에 특성행렬을 곱해서 사용합니다.

#27.
Spectral GCN 은
Laplacian filter를 이용해서 이미지속 오브젝트(노드)들간의 경계를 판단하고 이를 이용해서 노드들간의 거리를 계산하여 활용할 수 있게 해주는GCN입니다

#28.
spatial GCN 은
노드의 이웃들에 순서를 매겨야하는 상황에서 쓸 수 있는 GCN으로 노드가 위치한 공간특징을 활용합니다.

#29.
Spatial-Temporal GCN (STGCN)은
노드의 공간 및 시간 특성을 활용한 GCN으로 스마트교통, 스마트에너지, 스마트공장등에 활용됩니다.

#30.
GAN은 Graph Attention Networks의 약자로, 이웃노드의 중요도에따라 각기 다른 가중치를 할당할 수 있는 GNN입니다.

#31.
GGSNN은 Gated Graph Sequence Neural Networks의 약자로,
GCN과 GAN이 분류문제와같이 단순한 output을 내는 모델이라면 GGSNN은
단순한 output대신 output sequence를 출력하기위해 GRU를 정보의 전파 단계에 사용하여 정보의 전파 길이를 늘린 모델입니다.
이때, GRU를 사용한 GNN은 GGNN이라 하고 GGSNN은 output sequence를 생성하기위해 여러GGNN들을 이어붙인 GNN모델입니다.

#32.
Jump Knowledge Network는 GNN에서 각각의 레이어를 거치며 나온 임베딩값을 마지막단계에 모두 활용하는 임베딩구조입니다.
이미지의 지역정보를 집계할때 노드간의 거리가 너무 가까우면 발생하는 over-smoothing 문제를 해결할 수 있습니다.
논문에서는 그래프 특성을 행렬로 변환할때, 각노드에 적용할 이웃의 범위를 바꿀 수있는 GNN이라고 소개되어있습니다.

#33.
Self-Enhanced GNN은 반지도학습 분류문제에서의 성능 향상을 위해 기존GNN모델의 OUTPUT을 사용하여 입력 데이터의 품질을 개선하는 GNN모델입니다.

#34.
이중 저희가 주목한 모델은 STGCN입니다.
STGCN은 시간적, 공간적 특성을 모두 고려한다는 특징이있어서 다변량 시계열 데이터셋을 분석하기에 적합하다고 생각했습니다.

#35.
-------------------------------------------------------------------챕터5. [STGCN (E-STGCN)]---------------------------------------------------------------

#36.
STGCN을 분석하여 프로젝트에 활용하기위해 다음 논문을 참고하였습니다.
다음 논문은 IIOT분야의 이상탐지에 사용되어, 기기의 정비를 돕는 머신러닝 모델인 Electrical-STGCN를 다루고있습니다.

#37.
E-STGCN을 이용한다면 다음 IIOT분야의 고장을 정비하는 세가지 방법중
- 고장정비: 문제점이나 장애가 발생된 후에 수리합니다.
- 예방정비: 경험에 기반하여 예정된 수리가 이루어집니다.
- 예측정비: 자산에 대한 데이터가 장애가 임박했음을 표시하므로 수리가 이루어집니다.

#38
#39
#40

#41.
데이터 분석 후 고장을 예측하고 수리하는 예측정비(PDM)를 이용하여 

#42.
시스템의 남은 수명인 RUL을 측정하고, IIOT장비가 고장나기전 미리 정비를 할 수 있습니다.

#43.
기존의 PDM모델에서는 RUL을 측정하기위해
지원벡터머신(SVM), K-평균, 앙상블학습(EL), 인공신경망(ANN)의 네가지 주요 알고리즘들을 활용했습니다.

#44.
장비의 작동은 전압,전류 등 전기적 속성과 밀접한 관계가 있습니다.

#45.
또한 전기적 속성은 시간의 흐름에따라 계속 변합니다.

#46.
기존의 PDM모델은 공통적으로 이런 시간의 흐름을 고려하지않기때문에 성능이 떨어지는데,
Electrical-STGCN은 이러한 시간의 흐름에따른 전기적 속성의 변화를 고려하여 설계된 모델입니다.

#47.
다음은 논문을통해 학습한 Electrical-STGCN의 동작과정입니다. 

#48.
먼저 산업장비에 부착된 센서를 통해 데이터를 수집함
데이터는 오른쪽 표와 같습니다.

#49.
그런다음 수집된 데이터를 모델에 맞게 변환
수집한 데이터는 시간선을 따라서 
각 특성의 값들이 변화하는 데이터 시퀀스 인데
이를 모델에 맞게 그래프 형태의 구조화된 데이터로 변환해줘야함

대문자 X가 수집한 데이터이고, G가 구조화된 데이터
Gt는 t시점의 데이터를 의미하고, G에는 V,E,A 3가지 요소
V는 노드를 의미하는데 이 노드는 각 특성에 해당
E는 간선을 의미, 두 정점사이의 weight
A는 인접행렬을 의미합니다.

#50.
데이터를 변환했으면 다음은 커널함수를 사용해 
두 값을 계산하는데 similarity의 경우에는 t시점에서 두 정점의 유사도를 나타내는 인접 행렬
A pi는 라플라시안 행렬의 고유벡터입니다.
이 두개의 값을 하이퍼 파라미터를 넣어 합쳐서 사용

#51.
다음으로 앞서 구한 값들을 다음 식들을 통해 노말라이즈 한다.

#52.
다음은 컨볼루션 연산을 진행한다.
input 값으로는 앞에서 구한 similarity와 고유벡터값, 그리고 정점정보가 들어간다.
similarity와 고유벡터값은 t시점에서의 
특성들간의 potential interaction을 고려하여 식에 넣었다고 함

#53.
앞의 계산으로 나온 결과를 5개의 레이어로 되어있는
temporal residual layer에 넣고
이 결과를 다시 HPN 구조에 넣는다.
해당 과정을 통해 시스템의 남은 수명값인 RUL이 계산된다.

#54.
이후 모델의 파라미터를 업데이트 한 뒤
모델이 수렴할때 까지 에포크를 반복합니다.

#55.
다음은 E-STGCN 알고리즘과 기존PDM모델의 알고리즘들의 정확성, 정밀성등을 비교하여 나타낸 표이다.
E-STGCN알고리즘이 기타 알고리즘들에비해 우수함을 알 수 있습니다.

#56.
-------------------------------------------------------------------챕터5. [To do]---------------------------------------------------------------
여기까지가 현재 저희 팀이 이상치 탐지 모델을 만들기위해 연습용 모델을 만들어보고, 새로운 알고리즘을 학습한 내용들입니다.
앞으로 Hai dataset을 그래프형태로 변환한뒤 이에 맞는 STGCN모델을 만들어볼 계획입니다.
모델의 결과가 좋으면 해당 모델의 성능을 높이는 작업을 이어간뒤, 최종 모델도 STGCN을 이용하여 만들 생각입니다.

#57.
혹시 저희 프로젝트 관련해서 궁금하신 점이 있다면 아래 연락처로 문자나 메일주시면 됩니다.

#58.
이상 와 머신러닝 아시는구나 팀의 프로젝트 중간결과발표를 마치겠습니다. 감사합니다.


